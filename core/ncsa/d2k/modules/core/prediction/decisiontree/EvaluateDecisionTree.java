package ncsa.d2k.modules.core.prediction.decisiontree;

import ncsa.d2k.infrastructure.modules.*;
import ncsa.d2k.util.datatype.*;

/**
	Given a decision tree and a data set, run the data set through
	the decision tree.
*/
public class EvaluateDecisionTree extends ComputeModule {

	static String[] IN = {"ncsa.d2k.modules.core.prediction.decisiontree.DecisionTreeModel", "ncsa.d2k.util.datatype.ExampleTable"};
	static String[] OUT = {"ncsa.d2k.util.datatype.ExampleTable",
		"ncsa.d2k.modules.core.prediction.decisiontree.DecisionTreeModel"};
	static String IN0 = "A decision tree model.";
	static String IN1 = "A data set.";
	static String OUT0 = "The data set with an additional column of "
		+"predictions generated by the decision tree.";
	static String INFO = "Given a decision tree and a data set, run the "
		+"data set through the decision tree.";

	public String getModuleInfo() {
		return INFO;
	}

	public String[] getInputTypes() {
		return IN;
	}

	// change to prediction table
	public String[] getOutputTypes() {
		return OUT;
	}

	public String getInputInfo(int i) {
		if(i == 0)
			return IN0;
		return IN1;
	}

	public String getOutputInfo(int i) {
		return OUT0;
	}

	public void doit() {
		DecisionTreeModel mdl = (DecisionTreeModel)pullInput(0);
		ExampleTable et = (ExampleTable)pullInput(1);
		Table t = mdl.predict(et);
		pushOutput(t, 0);
		pushOutput(mdl, 1);
	}
}
